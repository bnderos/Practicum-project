# Восстановление золота из руды.
## Описание проекта
Данные находятся в трёх файлах:
- gold_industry_train.csv — обучающая выборка;
- gold_industry_test.csv — тестовая выборка;
- gold_industry_full.csv — исходные данные.

Данные индексируются датой и временем получения информации (признак date). Соседние по времени параметры часто похожи.   

Некоторые параметры недоступны, потому что замеряются и/или рассчитываются значительно позже. Из-за этого в тестовой выборке отсутствуют некоторые признаки, которые могут быть в обучающей. Также в тестовом наборе нет целевых признаков.    

Исходный датасет содержит обучающую и тестовую выборки со всеми признаками.   

В вашем распоряжении сырые данные: их просто выгрузили из хранилища. Прежде чем приступить к построению модели, проверьте по нашей инструкции их на корректность.
## Цель: Подготовьте прототип модели машинного обучения для компании «Цифры». Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды.
     
   Работа пройдёт в несколько этапов:
 1. Загрузка и подготовка данных.
 2. Анализ данных
 3. Обучение и проверка модели.
## Описание данных:     

#### Технологический процесс

+ Rougher feed — исходное сырье
+ Rougher additions (или reagent additions) — флотационные реагенты: Xanthate, Sulphate, Depressant
    + Xanthate — ксантогенат (промотер, или активатор флотации);
    + Sulphate — сульфат (на данном производстве сульфид натрия);
    + Depressant — депрессант (силикат натрия).
+ Rougher process (англ. «грубый процесс») — флотация
+ Rougher tails — отвальные хвосты
+ Float banks — флотационная установка
+ Cleaner process — очистка
+ Rougher Au — черновой концентрат золота
+ Final Au — финальный концентрат золота

#### Параметры этапов
+ air amount — объём воздуха
+ fluid levels — уровень жидкости
+ feed size — размер гранул сырья
+ feed rate — скорость подачи

### Наименование признаков:  

Наименование признаков должно быть такое:
[этап].[тип_параметра].[название_параметра]   

**Пример:** rougher.input.feed_ag        

#### Возможные значения для блока [этап]:

+ rougher — флотация
+ primary_cleaner — первичная очистка
+ secondary_cleaner — вторичная очистка
+ final — финальные характеристики

#### Возможные значения для блока [тип_параметра]:

+ input — параметры сырья
+ output — параметры продукта
+ state — параметры, характеризующие текущее состояние этапа
+ calculation — расчётные характеристики

## Общий вывод    
**При подготовке данных:**  
+ удалили столбец даты  
+ добавили таргеты в тест    
+ удалили из трейна признаки, которых нет в тесте
+ заполнили пропуски   
+ удалили из трейна (9,68%) и теста (7,7%) выбросы в таргете   

**Во втором пункте выяснили:**  

+ что концентрация золота с каждым этапом становится значительно выше     
+ распределения размеров гранул исходного сырья на обучающей и тестовой выборках не сильно отличаются друг от друга
+ суммарная концентрация металлов с каждым этапом меньше становится разброс значений, купол становится уже

**На третьем этапе:**   

+ написали функцию для вычисления итоговой sMAPE   
+ обучили разные модели и оценили их качество кросс-валидацией      
+ выбрали лучшую модель и проверили её на тестовой выборке
+ лучшую метрику sMAPE = 6.114606 показала модель CatBoost на трейне и sMAPE = 7.961482 на тесте     
